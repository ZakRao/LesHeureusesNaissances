{%extends 'AppBundle::Layout.html.twig'%}



{%block body%}
{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}


<div class="row bandeau-profil">
  <!-- Bandeau supérieur -->
  <div class="col-md-12">
    <div class="col-md-4 text-center">
      
      {% if (user.image)!=null %}
        <img  class="img-circle img-responsive" src= "{{ asset(user.image.webPath) }}" alt="{{ user.image.alt }}">
      {% else %}
        <img  class="img-circle img-responsive" src= "http://i57.servimg.com/u/f57/16/18/15/10/1866.jpg" height="">
      {% endif %}
    </div>

    <div class="col-md-4 text-center">
      <!-- Pseudo -->
      <h3 class="profil-username">{{ user.username }}</h4>
      
      <!-- Age -->
      <h3 >{{user.getAge()}} ans</h4>

      <!-- Age -->
      <h3 >Je suis "{{user.personnalite}}"</h4>

    </div>

    <div class="col-md-4 text-center">
      <h3 class="profil-username">{{ user.departement }}</h4>
      <h3>{{ user.ville }}</h4> 
      {%if app.user.id==user.id%}
          <a class="btn btn-filled" href="{{path('fos_user_profile_edit')}}">Modifier mon Profil</a>
      {% else %}
      <a class="btn btn-filled" href="{{ path('message_to_user', {'username': user.getUsername}) }}">Envoyez moi un message </a>

      {% endif %}

    </div>
  </div>
</div>



<div class="profil-firstsec">
        <div class="container">
            <div class="row">
            <div class="col-md-6">
                <h3 class="uppercase mt20">Qui suis-je ?</h3>
                <p class="lead">
                  <!-- Description -->
                  {{user.description}}
                </p>
            </div>
            <div class="col-md-6">
              <!-- Si l'utilisatrice est enceinte -->
                {% if user.enceinte == 1%}

                  <h3 class="uppercase mt20">Je suis enceinte</h3>

                  <p class="lead">

                  <!-- Date de fin de grossesse -->
                  Terme prévu en : {{user.datef.format('m/Y')}} <br>
                
                  {% if not user.enfants.empty%} <!-- Nombre d'enfants -->
                    J'ai {{user.enfants.count}} enfants
                    <div class="profil-enfants">
                      {% for enfant in user.enfants %}
                        <div class="col-sm-2 text-center">
                            {% if enfant.sexe == 'F'%}
                              <img src="{{asset('front/img/logo_fille.jpg')}}" alt="logo_fille">
                            {% else %}
                              <img src="{{asset('front/img/logo_garcon.jpg')}}" alt="logo_garcon">
                            {% endif %}
                            <p>{{enfant.getAge()}}</p>
                            <p>{{enfant.prenom}}</p>
                        </div>
                      {% endfor %}
                    </div>
                  {% else %}
                    Je n'ai pas encore d'enfant
                  {% endif %}

                </p>
                  {% else %}
                    <h3>Je ne suis pas enceinte</h3>
                    {% if not user.enfants.empty%} 
                      <!-- Nombre d'enfants -->
                      J'ai {{user.enfants.count}} enfants
                      <div class="profil-enfants">
                        {% for enfant in user.enfants %}
                          <div class="col-sm-2 text-center">
                              {% if enfant.sexe == 'F'%}
                                <img src="{{asset('front/img/logo_fille.jpg')}}" alt="logo_fille">
                              {% else %}
                                <img src="{{asset('front/img/logo_garcon.jpg')}}" alt="logo_garcon">
                              {% endif %}
                              <p>{{enfant.getAge()}}</p>
                              <p>{{enfant.prenom}}</p>
                          </div>
                        {% endfor %}
                      </div>
                  {% else %}
                    Je n'ai pas encore d'enfant
                  {% endif %}
                {% endif %}
            </div>

              </div>
            </div>
            </div>
        </div>
    </div>
    <div class="profil-secondsec">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h3 class="uppercase mt20">Mes disponibilités</h3>
                    

                    {% set possibilites = ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21'] %}


                    <table class="table table-bordered">
                      <thead>
                        <tr>
                          <th></th>
                          <th>Lundi</th>
                          <th>Mardi</th>
                          <th>Mercredi</th>
                          <th>Jeudi</th>
                          <th>Vendredi</th>
                          <th>Samedi</th>
                          <th>Dimanche</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th scope="row">Matin</th>
                          <td class="lundi-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 1%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="mardi-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 4%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="mercredi-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 7%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="jeudi-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 10%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="vendredi-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 13%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="samedi-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 16%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="dimanche-m
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 19%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                        </tr>
                        <tr>
                          <th scope="row">Après-midi</th>
                          <td class="lundi-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 2%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="mardi-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 5%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="mercredi-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 8%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="jeudi-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 11%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="vendredi-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 14%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="samedi-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 17%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="dimanche-am
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 20%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                        </tr>
                        <tr>
                          <th scope="row">Soirée</th>
                          <td class="lundi-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 3%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="mardi-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 6%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="mercredi-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 9%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="jeudi-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 12%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="vendredi-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 15%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="samedi-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 18%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                          <td class="dimanche-s
                          {% for dispo in user.disponibilites %}
                            {% if dispo.disponibilite == 21%}
                              success
                            {% endif %} 
                          {% endfor %}
                          "></td>
                        </tr>
                      </tbody>
                    </table>
      
                </div>
            </div>
        </div>
    </div>

    <div class="profil-thirdsec">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h3 class="uppercase mt20 mb50">J'ai partagé du temps avec ces mamans</h3> 
                    
                    {% if user.commentaires != null %}
                      {% for commentaire in user.commentaires %}
                        
                        <div class="col-md-10 col-md-offset-1 profil-comments">
                            <div class="col-md-10">
                              <h4 class="bold">{{commentaire.auteur}}</h4>
                            </div>
                            <!-- On test si l'utilisateur connecté est l'auteur du commentaire il peur supprimer le commentaire-->
                            {% if app.user.username==commentaire.auteur %}
                              <div class="col-md-2">
                                <a href="{{ path('app_user_delete_commentaire', {'id': commentaire.id}) }}" class="btn pull-right">
                                  <i class="glyphicon glyphicon-trash"></i>
                                  Supprimer 
                                </a>
                              </div>
                            {% endif %}

                            
                            <div class="clearfix"></div>
                            <!-- On test s'il le commentaire a une photo, S'il n'en a pas -->
                            {% if (commentaire.image)==null %}

                              <!-- On affiche le text dans un col-md-12 -->
                              <div class="col-md-12">
                                <p>
                                    {{ commentaire.contenu }}
                                </p>
                              </div>

                            <!-- S'il le commentaire a une image-->  
                            {% else %}

                              <!-- On affiche le contenu dans un col-md-6 -->
                              <div class="col-md-12">
                                <p>
                                    {{ commentaire.contenu }}
                                </p>
                              </div>

                              <!-- On affiche l'image dans un col-md-6 -->
                              <div class="col-md-8 col-md-offset-2 profil-comment-picture">
                                <img  class="img-responsive" src= "{{ asset(commentaire.image.webPath) }}" alt="{{ commentaire.image.alt }}">
                              </div>
                            {% endif %}

                            
                            <div class="col-md-10">
                              <i> Par {{ commentaire.auteur }} le {{commentaire.date | date('d/m/Y')}} </i>
                            </div>
                        </div>
                        
                        {% if not loop.last %} {% endif %}
                      {% endfor %}
                    {% else %}
                      Cette utilisateur n'a pas encore de commentaire
                    {% endif %}
                    

                    <div class="col-md-10 col-md-offset-1">
                      <hr>
                      <form role="form" method="POST"  enctype="multipart/form-data" action="{{path('app_user_add_commentaire', {'username' : user.username})}}">

                        <div class="col-md-12 text-center">
                          <textarea placeholder="Laissez un commentaire sur votre rencontre avec cette utilisatrice" name="commentaire" rows="3"></textarea>
                        </div>
                        <div class="input-with-label text-left col-md-10">
                          <span>Vous pouvez ajouter une photo à votre commentaire :</span>
                        </div>
                        <div class="col-md-5">
                          <input type= "file"  name="image" class="form-control">
                        </div>
                        <div class="col-md-12">
                          <button type="submit" class="btn btn-default">Envoyer</button>
                        </div>
                      </form>
                    </div>
                

            </div>

            
          </div>
        </div>
    </div>





    {% else %}
    <a href="{{ path('fos_user_security_login') }}">Connexion</a>
  {% endif %}

  {% block javascripts %}
    {# Ajoutez ces lignes JavaScript si vous comptez vous servir des fonctionnalités du bootstrap Twitter #}

    <script src="https://code.jquery.com/jquery-1.11.2.js"></script>
    <script src="{{asset('js/vendor/bootstrap.min.js')}}"></script>
    <script src="{{asset('js/vendor/modernizr-2.8.3-respond-1.4.2.min.js')}}"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
    <script src="{{asset('js/main.js')}}"></script>

    
  {% endblock %}
{% endblock %}
