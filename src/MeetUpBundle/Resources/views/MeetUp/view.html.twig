{% extends "MeetUpBundle:MeetUp:layout.html.twig" %}

{% block title %}
  Rencontre {{ parent() }}
{% endblock %}

{% block body %}

<div class="col-md-12 bandeau">
    <h1 class="text-center">{{ meet_up.titre }}</h1>
</div>

<div class="container" >
  <div class="row">
    <div class="col-md-3" style="margin-top:30px;">
        <div class="feature feature-2 bordered">
            <div class="text-center">
                <i class="ti-package icon-sm"></i>
                <h5 class="uppercase">Informations</h5>
            </div>
            <p>
              <strong>Département : </strong> {{meet_up.departement}}
            </p>
            <p>
              <strong>Lieu : </strong> {{meet_up.localisation}}
            </p>
            <p>
              <strong>Thème : </strong> {{meet_up.theme}}
            </p>
            <p>
              <strong>Propositions de date : </strong>
            </p>
            <p>
              {{meet_up.jour1 | date('d/m/Y')}} : 
              
              {% if meet_up.vote_jour1 < '2' %}
              {{ meet_up.vote_jour1 }} vote 
              <a href="{{ path('add_vote_jour1', {'id' : meet_up.id}) }}"><strong>+</strong></a>
              {% else %}
              {{ meet_up.vote_jour1 }} votes
              <a href="{{ path('add_vote_jour1', {'id' : meet_up.id}) }}"><strong>+</strong></a>
              {% endif %}
            </p>
            <p>
              {{meet_up.jour2 | date('d/m/Y')}}
              {% if meet_up.vote_jour2 < '2' %}
              {{ meet_up.vote_jour2 }} vote 
              <a href="{{ path('add_vote_jour2', {'id' : meet_up.id}) }}"><strong>+</strong></a>
              {% else %}
              {{ meet_up.vote_jour2 }} votes
              <a href="{{ path('add_vote_jour2', {'id' : meet_up.id}) }}"><strong>+</strong></a>
              {% endif %}
            </p>
            <p>
              {{meet_up.jour3 | date('d/m/Y')}}
              {% if meet_up.vote_jour3 < '2' %}
              {{ meet_up.vote_jour3 }} vote 
              <a href="{{ path('add_vote_jour3', {'id' : meet_up.id}) }}"><strong>+</strong></a>
              {% else %}
              {{ meet_up.vote_jour3 }} votes
              <a href="{{ path('add_vote_jour3', {'id' : meet_up.id}) }}"><strong>+</strong></a>
              {% endif %}
            </p>

            <hr>

            <p class="text-center">
              <strong>{{meet_up.listeparticipantes.count}}</strong>
            </p>
            <p class="text-center">
              <strong>Participants</strong>
            </p>
            <div class="text-center">

              {% if app.user.username!=meet_up.user and  not (meet_up.listeparticipantes.contains(app.user)) %}
                <a class="btn" href="{{ path('ajout_participante', {'id' : meet_up.id}) }}">Je participe
                </a> 

                {% elseif  meet_up.listeparticipantes.contains(app.user) %}
                <a class="btn" href="{{ path('suppression_participante', {'id' : meet_up.id}) }}"> Je ne participe plus
                </a> 

              {% endif %}
            </div>
        </div>
        <!--end of feature-->
    </div>
    
    <div class="col-md-9" style="margin-top:30px;">
        <div class="feature feature-2 bordered">
            <div class="text-center">
                <i class="ti-pulse icon-sm"></i>
                <h5 class="uppercase">La rencontre</h5>
            </div>
            <div class="text-center">
             <img alt="café" class="img-responsive" src="{{asset('front/img/cafe.jpg')}}"/>
            </div>
            <!-- La rencontre-->
            <div>
              <p>
                {{meet_up.description}}
              </p>
            </div>
            
            <!-- Commentaires -->
            <hr>

            <h2 class="text-center">Discussion</h2>
            <div>
              {% if meet_up.commentairesMeetUp != null %}
                {% for commentaireMeetUp in meet_up.commentairesMeetUp %}

                  <p>{{ commentaireMeetUp.contenu }}</p>
                  <p>Par {{ commentaireMeetUp.auteur }} à {{commentaireMeetUp.date | date('d/m/Y')}}
                  {% if app.user.username==commentaireMeetUp.auteur %}
                            <a href="{{ path('delete_commentaire_meet_up', {'id': commentaireMeetUp.id}) }}" >
                                <i class="glyphicon glyphicon-trash"></i>
                                    Supprimer 
                                </a>
                            {% endif %}
                  </p>
        
                  {% if not loop.last %}{% endif %}
                  {% endfor %}
              {% endif %}


               {%if app.user.username==meet_up.user%} 
               <a href="{{ path('delete_meet_up', {'id': meet_up.id}) }}" class="btn btn-danger">
               <i class="glyphicon glyphicon-trash"></i>
                Supprimer 
                </a>
                {% endif %} 
                <form role="form" method="POST" enctype="multipart/form-data" action = "{{ path('add_commentaire_meet_up', {'id': meet_up.id}) }}" >
                <div class="form-group">
                <input type= "text"   name="commentaire" placeholder="Commentaire" class="form-control">
                <input type= "file"  name="image" class="form-control">
                </div>
                <button type="submit" class="btn btn-default">Envoyer</button>
                </form>
            </div>
        </div>
        <!--end of feature-->
    </div>
    <div class="col-md-9 box-infos-meet-up mt20">
      
      <h2 class="text-center">La rencontre</h2>
      <div class="text-center">
       <img alt="café" class="img-responsive" src="{{asset('front/img/cafe.jpg')}}"/>
      </div>
      <!-- La rencontre-->
      <div>
        <p>
          {{meet_up.description}}
        </p>
      </div>
      
      <!-- Commentaires -->
      <hr>

      <h2 class="text-center">Discussion</h2>
      <div>
        {% if meet_up.commentairesMeetUp != null %}
          {% for commentaireMeetUp in meet_up.commentairesMeetUp %}

            <p>{{ commentaireMeetUp.contenu }}</p>
            <p>Par {{ commentaireMeetUp.auteur }} à {{commentaireMeetUp.date | date('d/m/Y')}}
            {% if app.user.username==commentaireMeetUp.auteur %}
                      <a href="{{ path('delete_commentaire_meet_up', {'id': commentaireMeetUp.id}) }}" >
                          <i class="glyphicon glyphicon-trash"></i>
                              Supprimer 
                          </a>
                      {% endif %}
            </p>
  
            {% if not loop.last %}{% endif %}
            {% endfor %}
        {% endif %}


         {%if app.user.username==meet_up.user%} 
         <a href="{{ path('delete_meet_up', {'id': meet_up.id}) }}" class="btn btn-danger">
         <i class="glyphicon glyphicon-trash"></i>
          Supprimer 
          </a>
          {% endif %} 
          <form role="form" method="POST" enctype="multipart/form-data" action = "{{ path('add_commentaire_meet_up', {'id': meet_up.id}) }}" >
          <div class="form-group">
          <input type= "text"   name="commentaire" placeholder="Commentaire" class="form-control">
          <input type= "file"  name="image" class="form-control">
          </div>
          <button type="submit" class="btn btn-default">Envoyer</button>
          </form>
      </div>
    </div>

    <div class="clearfix"></div>

    <!-- Les participants -->
    <div class="col-md-3 box-infos-meet-up mt20 mb50">
      <h2 class="text-center">Participantes</h2>

      {% if not meet_up.listeparticipantes.empty%} 
        {% for participant in meet_up.listeparticipantes %}
          <p>- {{participant.getUsername()}}</p>
        {% endfor %}
      {% else %}
        <p>Pas encore de participantes</p>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}